# SplatStream
Python bindings for streamlined 3dgs rendering.

[![Build Status](https://github.com/jaesung-cs/splatstream/workflows/Build%20Python%20Package/badge.svg)](https://github.com/jaesung-cs/splatstream/actions/workflows/build.yml)
[![Release Status](https://github.com/jaesung-cs/splatstream/workflows/Release%20Python%20Package/badge.svg)](https://github.com/jaesung-cs/splatstream/actions/workflows/release.yml)
[![Python Versions](https://img.shields.io/badge/python-3.10%20%7C%203.11%20%7C%203.12-blue.svg)](https://www.python.org/downloads/)
[![Platforms](https://img.shields.io/badge/platform-linux%20%7C%20windows%20%7C%20macos-lightgrey.svg)](https://github.com/jaesung-cs/splatstream/actions)

This is a more modularized and organized code of my previous c++ project [vkgs](https://github.com/jaesung-cs/vkgs).

This code is being actively developed, so expect some bugs until the codes are stabilized.

![train](/media/train.gif) ![random](/media/random.gif)

Animation generated by `splatstream`.
- Left: train
- Right: result of `test/test_random.py`. Color and alpha images for randomly generated splats with repeating background.
```python
import splatstream as ss
splats = ss.load_from_ply("my_splats.ply")
images = ss.draw(
  splats,
  viewmats,          # np.ndarray, (..., 4, 4)
  Ks,                # np.ndarray, (..., 3, 3)
  width,             # int
  height,            # int
  near=0.1, far=1e3  # Do not use too low near nor too high far, otherwise z-fighting
).numpy()            # np.ndarray, (..., H, W, 3), np.uint8

from PIL import Image
for i in range(len(images)):
  Image.fromarray(images[i, :, :, :3]).save(f"color_{i}.png")
  Image.fromarray(images[i, :, :, 3]).save(f"alpha_{i}.png")
```

## Feature Highlights
- Fast speed: rasterization using Graphics capability.
- Memory-efficiency: reuse resources by double buffering.
- Pure Vulkan with a minimal set of dependencies. No CUDA required.

## Limitations
- Only `.ply` format files with SH degree 3 are importable; pretrained from the [original Gaussian Splatting](https://github.com/graphdeco-inria/gaussian-splatting) codes.
- No gradient computation; this code is for rendering, not training.
- Rendering image slightly differs from `gsplat` (suspectedly due to splat culling logic, i.e. frustum test, near plane of the camera)
- No package, no distribution yet, need to install VulkanSDK, build from source and install this package by yourself.

## Requirements
- `VulkanSDK>=1.4.328.1`
  - `VK_KHR_push_descriptor` has been promoted to 1.4 and is supported by `MoltenVK` in `MacOS` since the bug was fixed in `1.4.328.1`.
- `cmake>=3.15`
  - Either system-installed or via pip or conda.
    ```bash
    $ pip install cmake
    or
    $ conda install conda-forge::cmake
    ```
- Python dependencies
  - Includes build tools.
    ```bash
    $ pip install -r requirements.txt
    ```

## Build Python Module
```bash
$ pip install ./binding
```

## Build c++
```bash
$ cmake . -B build
$ cmake --build build --config Release -j
```

## TODO
- [x] Support SH degree
- [x] Support background color
- [ ] Device selection
- [ ] c++ viewer
- [x] Build wheels and publish
- [ ] Find reasons for pixel value difference with `gsplat`

## Contribution

- Feedback, feature request, issue report, or PRs are welcome!
- c++ must be formatted with `clang-format` with rules defined in `.clang-format`.
- python shall be formatted, but no specific formatter yet.

## Technical Details

See [here](/DETAILS.md).
